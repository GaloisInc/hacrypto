<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>abstract</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.78.1">
<link rel="home" href="index.html" title="GnuTLS API Reference Manual">
<link rel="up" href="intro.html" title="GnuTLS API Reference Manual">
<link rel="prev" href="gnutls-gnutls.html" title="gnutls">
<link rel="next" href="gnutls-x509.html" title="x509">
<meta name="generator" content="GTK-Doc V1.19 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2">
<tr valign="middle">
<td><a accesskey="p" href="gnutls-gnutls.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td>
<td><a accesskey="u" href="intro.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td>
<th width="100%" align="center">GnuTLS API Reference Manual</th>
<td><a accesskey="n" href="gnutls-x509.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></a></td>
</tr>
<tr><td colspan="5" class="shortcuts">
<a href="#gnutls-abstract.synopsis" class="shortcut">Top</a>
                  Â |Â 
                  <a href="#gnutls-abstract.description" class="shortcut">Description</a>
</td></tr>
</table>
<div class="refentry">
<a name="gnutls-abstract"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="gnutls-abstract.top_of_page"></a>abstract</span></h2>
<p>abstract</p>
</td>
<td valign="top" align="right"></td>
</tr></table></div>
<div class="refsynopsisdiv">
<a name="gnutls-abstract.synopsis"></a><h2>Synopsis</h2>
<pre class="synopsis">#define             <a class="link" href="gnutls-abstract.html#GNUTLS-PCERT-NO-CERT:CAPS" title="GNUTLS_PCERT_NO_CERT">GNUTLS_PCERT_NO_CERT</a>
#define             <a class="link" href="gnutls-abstract.html#GNUTLS-PUBKEY-VERIFY-FLAG-TLS-RSA:CAPS" title="GNUTLS_PUBKEY_VERIFY_FLAG_TLS_RSA">GNUTLS_PUBKEY_VERIFY_FLAG_TLS_RSA</a>
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-certificate-set-key" title="gnutls_certificate_set_key ()">gnutls_certificate_set_key</a>          (<em class="parameter"><code><span class="type">gnutls_certificate_credentials_t</span> res</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> **names</code></em>,
                                                         <em class="parameter"><code><span class="type">int</span> names_size</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert_list</code></em>,
                                                         <em class="parameter"><code><span class="type">int</span> pcert_list_size</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>);
<span class="returnvalue">void</span>                <a class="link" href="gnutls-abstract.html#gnutls-certificate-set-retrieve-function2" title="gnutls_certificate_set_retrieve_function2 ()">gnutls_certificate_set_retrieve_function2</a>
                                                        (<em class="parameter"><code><span class="type">gnutls_certificate_credentials_t</span> cred</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_certificate_retrieve_function2</span> *func</code></em>);
<span class="returnvalue">void</span>                <a class="link" href="gnutls-abstract.html#gnutls-pcert-deinit" title="gnutls_pcert_deinit ()">gnutls_pcert_deinit</a>                 (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pcert-import-openpgp" title="gnutls_pcert_import_openpgp ()">gnutls_pcert_import_openpgp</a>         (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-openpgp-crt-t"><span class="type">gnutls_openpgp_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pcert-import-openpgp-raw" title="gnutls_pcert_import_openpgp_raw ()">gnutls_pcert_import_openpgp_raw</a>     (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *cert</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-openpgp.html#gnutls-openpgp-crt-fmt-t" title="enum gnutls_openpgp_crt_fmt_t"><span class="type">gnutls_openpgp_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-openpgp.html#gnutls-openpgp-keyid-t"><span class="type">gnutls_openpgp_keyid_t</span></a> keyid</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pcert-import-x509" title="gnutls_pcert_import_x509 ()">gnutls_pcert_import_x509</a>            (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pcert-import-x509-raw" title="gnutls_pcert_import_x509_raw ()">gnutls_pcert_import_x509_raw</a>        (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *cert</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pcert-list-import-x509-raw" title="gnutls_pcert_list_import_x509_raw ()">gnutls_pcert_list_import_x509_raw</a>   (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcerts</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *pcert_max</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-decrypt-data" title="gnutls_privkey_decrypt_data ()">gnutls_privkey_decrypt_data</a>         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *ciphertext</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *plaintext</code></em>);
<span class="returnvalue">int</span>                 (<a class="link" href="gnutls-abstract.html#gnutls-privkey-decrypt-func" title="gnutls_privkey_decrypt_func ()">*gnutls_privkey_decrypt_func</a>)      (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *ciphertext</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *plaintext</code></em>);
<span class="returnvalue">void</span>                <a class="link" href="gnutls-abstract.html#gnutls-privkey-deinit" title="gnutls_privkey_deinit ()">gnutls_privkey_deinit</a>               (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>);
<span class="returnvalue">void</span>                (<a class="link" href="gnutls-abstract.html#gnutls-privkey-deinit-func" title="gnutls_privkey_deinit_func ()">*gnutls_privkey_deinit_func</a>)       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>);
enum                <a class="link" href="gnutls-abstract.html#gnutls-privkey-flags-t" title="enum gnutls_privkey_flags_t">gnutls_privkey_flags_t</a>;
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-get-pk-algorithm" title="gnutls_privkey_get_pk_algorithm ()">gnutls_privkey_get_pk_algorithm</a>     (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *bits</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-ext" title="gnutls_privkey_import_ext ()">gnutls_privkey_import_ext</a>           (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-pk-algorithm-t" title="enum gnutls_pk_algorithm_t"><span class="type">gnutls_pk_algorithm_t</span></a> pk</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-sign-func" title="gnutls_privkey_sign_func ()"><span class="type">gnutls_privkey_sign_func</span></a> sign_func</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-decrypt-func" title="gnutls_privkey_decrypt_func ()"><span class="type">gnutls_privkey_decrypt_func</span></a> decrypt_func</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-ext2" title="gnutls_privkey_import_ext2 ()">gnutls_privkey_import_ext2</a>          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-pk-algorithm-t" title="enum gnutls_pk_algorithm_t"><span class="type">gnutls_pk_algorithm_t</span></a> pk</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-sign-func" title="gnutls_privkey_sign_func ()"><span class="type">gnutls_privkey_sign_func</span></a> sign_func</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-decrypt-func" title="gnutls_privkey_decrypt_func ()"><span class="type">gnutls_privkey_decrypt_func</span></a> decrypt_func</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-deinit-func" title="gnutls_privkey_deinit_func ()"><span class="type">gnutls_privkey_deinit_func</span></a> deinit_func</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-openpgp" title="gnutls_privkey_import_openpgp ()">gnutls_privkey_import_openpgp</a>       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-openpgp-privkey-t"><span class="type">gnutls_openpgp_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-openpgp-raw" title="gnutls_privkey_import_openpgp_raw ()">gnutls_privkey_import_openpgp_raw</a>   (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-openpgp.html#gnutls-openpgp-crt-fmt-t" title="enum gnutls_openpgp_crt_fmt_t"><span class="type">gnutls_openpgp_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <a href="gnutls-openpgp.html#gnutls-openpgp-keyid-t"><span class="type">gnutls_openpgp_keyid_t</span></a> keyid</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *password</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-pkcs11" title="gnutls_privkey_import_pkcs11 ()">gnutls_privkey_import_pkcs11</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-pkcs11-privkey-t"><span class="type">gnutls_pkcs11_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-pkcs11-url" title="gnutls_privkey_import_pkcs11_url ()">gnutls_privkey_import_pkcs11_url</a>    (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-tpm-raw" title="gnutls_privkey_import_tpm_raw ()">gnutls_privkey_import_tpm_raw</a>       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *fdata</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-tpm.html#gnutls-tpmkey-fmt-t" title="enum gnutls_tpmkey_fmt_t"><span class="type">gnutls_tpmkey_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *srk_password</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *key_password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-tpm-url" title="gnutls_privkey_import_tpm_url ()">gnutls_privkey_import_tpm_url</a>       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *srk_password</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *key_password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-url" title="gnutls_privkey_import_url ()">gnutls_privkey_import_url</a>           (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-x509" title="gnutls_privkey_import_x509 ()">gnutls_privkey_import_x509</a>          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-privkey-t"><span class="type">gnutls_x509_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-x509-raw" title="gnutls_privkey_import_x509_raw ()">gnutls_privkey_import_x509_raw</a>      (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-init" title="gnutls_privkey_init ()">gnutls_privkey_init</a>                 (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> *key</code></em>);
<span class="returnvalue">void</span>                <a class="link" href="gnutls-abstract.html#gnutls-privkey-set-pin-function" title="gnutls_privkey_set_pin_function ()">gnutls_privkey_set_pin_function</a>     (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_pin_callback_t</span> fn</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-sign-data" title="gnutls_privkey_sign_data ()">gnutls_privkey_sign_data</a>            (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> signer</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> hash</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *signature</code></em>);
<span class="returnvalue">int</span>                 (<a class="link" href="gnutls-abstract.html#gnutls-privkey-sign-func" title="gnutls_privkey_sign_func ()">*gnutls_privkey_sign_func</a>)         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *raw_data</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *signature</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-sign-hash" title="gnutls_privkey_sign_hash ()">gnutls_privkey_sign_hash</a>            (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> signer</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> hash_algo</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *hash_data</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *signature</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-privkey-status" title="gnutls_privkey_status ()">gnutls_privkey_status</a>               (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>);
<span class="returnvalue">void</span>                <a class="link" href="gnutls-abstract.html#gnutls-pubkey-deinit" title="gnutls_pubkey_deinit ()">gnutls_pubkey_deinit</a>                (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-encrypt-data" title="gnutls_pubkey_encrypt_data ()">gnutls_pubkey_encrypt_data</a>          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *plaintext</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *ciphertext</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-export" title="gnutls_pubkey_export ()">gnutls_pubkey_export</a>                (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *output_data</code></em>,
                                                         <em class="parameter"><code><span class="type">size_t</span> *output_data_size</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-export2" title="gnutls_pubkey_export2 ()">gnutls_pubkey_export2</a>               (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *out</code></em>);
enum                <a class="link" href="gnutls-abstract.html#gnutls-pubkey-flags-t" title="enum gnutls_pubkey_flags_t">gnutls_pubkey_flags_t</a>;
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-key-id" title="gnutls_pubkey_get_key_id ()">gnutls_pubkey_get_key_id</a>            (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">char</span> *output_data</code></em>,
                                                         <em class="parameter"><code><span class="type">size_t</span> *output_data_size</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-key-usage" title="gnutls_pubkey_get_key_usage ()">gnutls_pubkey_get_key_usage</a>         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *usage</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-openpgp-key-id" title="gnutls_pubkey_get_openpgp_key_id ()">gnutls_pubkey_get_openpgp_key_id</a>    (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">char</span> *output_data</code></em>,
                                                         <em class="parameter"><code><span class="type">size_t</span> *output_data_size</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *subkey</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-pk-algorithm" title="gnutls_pubkey_get_pk_algorithm ()">gnutls_pubkey_get_pk_algorithm</a>      (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *bits</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-pk-dsa-raw" title="gnutls_pubkey_get_pk_dsa_raw ()">gnutls_pubkey_get_pk_dsa_raw</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *p</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *q</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *g</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *y</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-pk-ecc-raw" title="gnutls_pubkey_get_pk_ecc_raw ()">gnutls_pubkey_get_pk_ecc_raw</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-ecc-curve-t" title="enum gnutls_ecc_curve_t"><span class="type">gnutls_ecc_curve_t</span></a> *curve</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *x</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *y</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-pk-ecc-x962" title="gnutls_pubkey_get_pk_ecc_x962 ()">gnutls_pubkey_get_pk_ecc_x962</a>       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *parameters</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *ecpoint</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-pk-rsa-raw" title="gnutls_pubkey_get_pk_rsa_raw ()">gnutls_pubkey_get_pk_rsa_raw</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *m</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *e</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-preferred-hash-algorithm" title="gnutls_pubkey_get_preferred_hash_algorithm ()">gnutls_pubkey_get_preferred_hash_algorithm</a>
                                                        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> *hash</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *mand</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-verify-algorithm" title="gnutls_pubkey_get_verify_algorithm ()">gnutls_pubkey_get_verify_algorithm</a>  (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *signature</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> *hash</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import" title="gnutls_pubkey_import ()">gnutls_pubkey_import</a>                (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-dsa-raw" title="gnutls_pubkey_import_dsa_raw ()">gnutls_pubkey_import_dsa_raw</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *p</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *q</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *g</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *y</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-ecc-raw" title="gnutls_pubkey_import_ecc_raw ()">gnutls_pubkey_import_ecc_raw</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-ecc-curve-t" title="enum gnutls_ecc_curve_t"><span class="type">gnutls_ecc_curve_t</span></a> curve</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *x</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *y</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-ecc-x962" title="gnutls_pubkey_import_ecc_x962 ()">gnutls_pubkey_import_ecc_x962</a>       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *parameters</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *ecpoint</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-openpgp" title="gnutls_pubkey_import_openpgp ()">gnutls_pubkey_import_openpgp</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-openpgp-crt-t"><span class="type">gnutls_openpgp_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-openpgp-raw" title="gnutls_pubkey_import_openpgp_raw ()">gnutls_pubkey_import_openpgp_raw</a>    (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-openpgp.html#gnutls-openpgp-crt-fmt-t" title="enum gnutls_openpgp_crt_fmt_t"><span class="type">gnutls_openpgp_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <a href="gnutls-openpgp.html#gnutls-openpgp-keyid-t"><span class="type">gnutls_openpgp_keyid_t</span></a> keyid</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-pkcs11" title="gnutls_pubkey_import_pkcs11 ()">gnutls_pubkey_import_pkcs11</a>         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-pkcs11.html#gnutls-pkcs11-obj-t" title="gnutls_pkcs11_obj_t"><span class="type">gnutls_pkcs11_obj_t</span></a> obj</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-pkcs11-url" title="gnutls_pubkey_import_pkcs11_url ()">gnutls_pubkey_import_pkcs11_url</a>     (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-privkey" title="gnutls_pubkey_import_privkey ()">gnutls_pubkey_import_privkey</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> usage</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-rsa-raw" title="gnutls_pubkey_import_rsa_raw ()">gnutls_pubkey_import_rsa_raw</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *m</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *e</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-tpm-raw" title="gnutls_pubkey_import_tpm_raw ()">gnutls_pubkey_import_tpm_raw</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *fdata</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-tpm.html#gnutls-tpmkey-fmt-t" title="enum gnutls_tpmkey_fmt_t"><span class="type">gnutls_tpmkey_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *srk_password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-tpm-url" title="gnutls_pubkey_import_tpm_url ()">gnutls_pubkey_import_tpm_url</a>        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *srk_password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-url" title="gnutls_pubkey_import_url ()">gnutls_pubkey_import_url</a>            (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-x509" title="gnutls_pubkey_import_x509 ()">gnutls_pubkey_import_x509</a>           (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-x509-crq" title="gnutls_pubkey_import_x509_crq ()">gnutls_pubkey_import_x509_crq</a>       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-x509.html#gnutls-x509-crq-t"><span class="type">gnutls_x509_crq_t</span></a> crq</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-x509-raw" title="gnutls_pubkey_import_x509_raw ()">gnutls_pubkey_import_x509_raw</a>       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-init" title="gnutls_pubkey_init ()">gnutls_pubkey_init</a>                  (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> *key</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-set-key-usage" title="gnutls_pubkey_set_key_usage ()">gnutls_pubkey_set_key_usage</a>         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> usage</code></em>);
<span class="returnvalue">void</span>                <a class="link" href="gnutls-abstract.html#gnutls-pubkey-set-pin-function" title="gnutls_pubkey_set_pin_function ()">gnutls_pubkey_set_pin_function</a>      (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_pin_callback_t</span> fn</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-verify-data" title="gnutls_pubkey_verify_data ()">gnutls_pubkey_verify_data</a>           (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pubkey</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *signature</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-verify-data2" title="gnutls_pubkey_verify_data2 ()">gnutls_pubkey_verify_data2</a>          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pubkey</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-sign-algorithm-t" title="enum gnutls_sign_algorithm_t"><span class="type">gnutls_sign_algorithm_t</span></a> algo</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *signature</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-pubkey-verify-hash2" title="gnutls_pubkey_verify_hash2 ()">gnutls_pubkey_verify_hash2</a>          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-sign-algorithm-t" title="enum gnutls_sign_algorithm_t"><span class="type">gnutls_sign_algorithm_t</span></a> algo</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *hash</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *signature</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-x509-crl-privkey-sign" title="gnutls_x509_crl_privkey_sign ()">gnutls_x509_crl_privkey_sign</a>        (<em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crl-t"><span class="type">gnutls_x509_crl_t</span></a> crl</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> issuer</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> issuer_key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> dig</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-x509-crq-privkey-sign" title="gnutls_x509_crq_privkey_sign ()">gnutls_x509_crq_privkey_sign</a>        (<em class="parameter"><code><a href="gnutls-x509.html#gnutls-x509-crq-t"><span class="type">gnutls_x509_crq_t</span></a> crq</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> dig</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-x509-crq-set-pubkey" title="gnutls_x509_crq_set_pubkey ()">gnutls_x509_crq_set_pubkey</a>          (<em class="parameter"><code><a href="gnutls-x509.html#gnutls-x509-crq-t"><span class="type">gnutls_x509_crq_t</span></a> crq</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-x509-crt-privkey-sign" title="gnutls_x509_crt_privkey_sign ()">gnutls_x509_crt_privkey_sign</a>        (<em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> issuer</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> issuer_key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> dig</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);
<span class="returnvalue">int</span>                 <a class="link" href="gnutls-abstract.html#gnutls-x509-crt-set-pubkey" title="gnutls_x509_crt_set_pubkey ()">gnutls_x509_crt_set_pubkey</a>          (<em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>);
</pre>
</div>
<div class="refsect1">
<a name="gnutls-abstract.description"></a><h2>Description</h2>
<p>
</p>
</div>
<div class="refsect1">
<a name="gnutls-abstract.details"></a><h2>Details</h2>
<div class="refsect2">
<a name="GNUTLS-PCERT-NO-CERT:CAPS"></a><h3>GNUTLS_PCERT_NO_CERT</h3>
<pre class="programlisting">#define GNUTLS_PCERT_NO_CERT 1
</pre>
<p>
</p>
</div>
<hr>
<div class="refsect2">
<a name="GNUTLS-PUBKEY-VERIFY-FLAG-TLS-RSA:CAPS"></a><h3>GNUTLS_PUBKEY_VERIFY_FLAG_TLS_RSA</h3>
<pre class="programlisting">#define GNUTLS_PUBKEY_VERIFY_FLAG_TLS_RSA GNUTLS_PUBKEY_VERIFY_FLAG_TLS1_RSA
</pre>
<p>
</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-certificate-set-key"></a><h3>gnutls_certificate_set_key ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_certificate_set_key          (<em class="parameter"><code><span class="type">gnutls_certificate_credentials_t</span> res</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> **names</code></em>,
                                                         <em class="parameter"><code><span class="type">int</span> names_size</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert_list</code></em>,
                                                         <em class="parameter"><code><span class="type">int</span> pcert_list_size</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>);</pre>
<p>
This function sets a certificate/private key pair in the
gnutls_certificate_credentials_t structure.  This function may be
called more than once, in case multiple keys/certificates exist for
the server.  For clients that wants to send more than its own end
entity certificate (e.g., also an intermediate CA cert) then put
the certificate chain in <em class="parameter"><code>pcert_list</code></em>. 
</p>
<p>
Note that the <em class="parameter"><code>pcert_list</code></em> and <em class="parameter"><code>key</code></em> will become part of the credentials 
structure and must not be deallocated. They will be automatically deallocated 
when the <em class="parameter"><code>res</code></em> structure is deinitialized.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>res</code></em>Â :</span></p></td>
<td>is a <span class="type">gnutls_certificate_credentials_t</span> structure.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>names</code></em>Â :</span></p></td>
<td>is an array of DNS name of the certificate (NULL if none)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>names_size</code></em>Â :</span></p></td>
<td>holds the size of the names list</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>pcert_list</code></em>Â :</span></p></td>
<td>contains a certificate list (path) for the specified private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>pcert_list_size</code></em>Â :</span></p></td>
<td>holds the size of the certificate list</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>is a <a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>
<a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) on success, or a negative error code.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-certificate-set-retrieve-function2"></a><h3>gnutls_certificate_set_retrieve_function2 ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>                gnutls_certificate_set_retrieve_function2
                                                        (<em class="parameter"><code><span class="type">gnutls_certificate_credentials_t</span> cred</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_certificate_retrieve_function2</span> *func</code></em>);</pre>
<p>
This function sets a callback to be called in order to retrieve the
certificate to be used in the handshake.
</p>
<p>
The callback's function prototype is:
int (*callback)(gnutls_session_t, const gnutls_datum_t* req_ca_dn, int nreqs,
const gnutls_pk_algorithm_t* pk_algos, int pk_algos_length, gnutls_pcert_st** pcert,
unsigned int *pcert_length, gnutls_privkey_t * pkey);
</p>
<p>
<em class="parameter"><code>req_ca_cert</code></em> is only used in X.509 certificates.
Contains a list with the CA names that the server considers trusted.
Normally we should send a certificate that is signed
by one of these CAs. These names are DER encoded. To get a more
meaningful value use the function <a class="link" href="gnutls-x509.html#gnutls-x509-rdn-get" title="gnutls_x509_rdn_get ()"><code class="function">gnutls_x509_rdn_get()</code></a>.
</p>
<p>
<em class="parameter"><code>pk_algos</code></em> contains a list with server's acceptable signature algorithms.
The certificate returned should support the server's given algorithms.
</p>
<p>
<em class="parameter"><code>pcert</code></em> should contain a single certificate and public or a list of them.
</p>
<p>
<em class="parameter"><code>pcert_length</code></em> is the size of the previous list.
</p>
<p>
<em class="parameter"><code>pkey</code></em> is the private key.
</p>
<p>
If the callback function is provided then gnutls will call it, in the
handshake, after the certificate request message has been received.
</p>
<p>
In server side pk_algos and req_ca_dn are NULL.
</p>
<p>
The callback function should set the certificate list to be sent,
and return 0 on success. If no certificate was selected then the
number of certificates should be set to zero. The value (-1)
indicates error and the handshake will be terminated.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>cred</code></em>Â :</span></p></td>
<td>is a <span class="type">gnutls_certificate_credentials_t</span> structure.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>func</code></em>Â :</span></p></td>
<td>is the callback function</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pcert-deinit"></a><h3>gnutls_pcert_deinit ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>                gnutls_pcert_deinit                 (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>);</pre>
<p>
This function will deinitialize a pcert structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>pcert</code></em>Â :</span></p></td>
<td>The structure to be deinitialized</td>
</tr></tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pcert-import-openpgp"></a><h3>gnutls_pcert_import_openpgp ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pcert_import_openpgp         (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-openpgp-crt-t"><span class="type">gnutls_openpgp_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This convenience function will import the given certificate to a
<span class="type">gnutls_pcert_st</span> structure. The structure must be deinitialized
afterwards using <a class="link" href="gnutls-abstract.html#gnutls-pcert-deinit" title="gnutls_pcert_deinit ()"><code class="function">gnutls_pcert_deinit()</code></a>;
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pcert</code></em>Â :</span></p></td>
<td>The pcert structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crt</code></em>Â :</span></p></td>
<td>The raw certificate to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>zero for now</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pcert-import-openpgp-raw"></a><h3>gnutls_pcert_import_openpgp_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pcert_import_openpgp_raw     (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *cert</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-openpgp.html#gnutls-openpgp-crt-fmt-t" title="enum gnutls_openpgp_crt_fmt_t"><span class="type">gnutls_openpgp_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-openpgp.html#gnutls-openpgp-keyid-t"><span class="type">gnutls_openpgp_keyid_t</span></a> keyid</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This convenience function will import the given certificate to a
<span class="type">gnutls_pcert_st</span> structure. The structure must be deinitialized
afterwards using <a class="link" href="gnutls-abstract.html#gnutls-pcert-deinit" title="gnutls_pcert_deinit ()"><code class="function">gnutls_pcert_deinit()</code></a>;
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pcert</code></em>Â :</span></p></td>
<td>The pcert structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cert</code></em>Â :</span></p></td>
<td>The raw certificate to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>The format of the certificate</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyid</code></em>Â :</span></p></td>
<td>The key ID to use (NULL for the master key)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>zero for now</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pcert-import-x509"></a><h3>gnutls_pcert_import_x509 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pcert_import_x509            (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This convenience function will import the given certificate to a
<span class="type">gnutls_pcert_st</span> structure. The structure must be deinitialized
afterwards using <a class="link" href="gnutls-abstract.html#gnutls-pcert-deinit" title="gnutls_pcert_deinit ()"><code class="function">gnutls_pcert_deinit()</code></a>;
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pcert</code></em>Â :</span></p></td>
<td>The pcert structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crt</code></em>Â :</span></p></td>
<td>The raw certificate to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>zero for now</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pcert-import-x509-raw"></a><h3>gnutls_pcert_import_x509_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pcert_import_x509_raw        (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcert</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *cert</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This convenience function will import the given certificate to a
<span class="type">gnutls_pcert_st</span> structure. The structure must be deinitialized
afterwards using <a class="link" href="gnutls-abstract.html#gnutls-pcert-deinit" title="gnutls_pcert_deinit ()"><code class="function">gnutls_pcert_deinit()</code></a>;
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pcert</code></em>Â :</span></p></td>
<td>The pcert structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>cert</code></em>Â :</span></p></td>
<td>The raw certificate to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>The format of the certificate</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>zero for now</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pcert-list-import-x509-raw"></a><h3>gnutls_pcert_list_import_x509_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pcert_list_import_x509_raw   (<em class="parameter"><code><span class="type">gnutls_pcert_st</span> *pcerts</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *pcert_max</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will convert the given PEM encoded certificate list
to the native gnutls_x509_crt_t format. The output will be stored
in <em class="parameter"><code>certs</code></em>.  They will be automatically initialized.
</p>
<p>
If the Certificate is PEM encoded it should have a header of "X509
CERTIFICATE", or "CERTIFICATE".
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pcerts</code></em>Â :</span></p></td>
<td>The structures to store the parsed certificate. Must not be initialized.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>pcert_max</code></em>Â :</span></p></td>
<td>Initially must hold the maximum number of certs. It will be updated with the number of certs available.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em>Â :</span></p></td>
<td>The certificates.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>One of DER or PEM.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>must be (0) or an OR'd sequence of gnutls_certificate_import_flags.</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>the number of certificates read or a negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-decrypt-data"></a><h3>gnutls_privkey_decrypt_data ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_decrypt_data         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *ciphertext</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *plaintext</code></em>);</pre>
<p>
This function will decrypt the given data using the algorithm
supported by the private key.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>zero for now</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ciphertext</code></em>Â :</span></p></td>
<td>holds the data to be decrypted</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>plaintext</code></em>Â :</span></p></td>
<td>will contain the decrypted data, allocated with <a href="gnutls-gnutls.html#gnutls-malloc"><code class="function">gnutls_malloc()</code></a>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-decrypt-func"></a><h3>gnutls_privkey_decrypt_func ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 (*gnutls_privkey_decrypt_func)      (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *ciphertext</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *plaintext</code></em>);</pre>
<p>
</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-deinit"></a><h3>gnutls_privkey_deinit ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>                gnutls_privkey_deinit               (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>);</pre>
<p>
This function will deinitialize a private key structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The structure to be deinitialized</td>
</tr></tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-deinit-func"></a><h3>gnutls_privkey_deinit_func ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>                (*gnutls_privkey_deinit_func)       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>);</pre>
<p>
</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-flags-t"></a><h3>enum gnutls_privkey_flags_t</h3>
<pre class="programlisting">typedef enum {
	GNUTLS_PRIVKEY_IMPORT_AUTO_RELEASE = 1,
	GNUTLS_PRIVKEY_IMPORT_COPY = 1 &lt;&lt; 1,
	GNUTLS_PRIVKEY_DISABLE_CALLBACKS = 1 &lt;&lt; 2,
	GNUTLS_PRIVKEY_SIGN_FLAG_TLS1_RSA = 1 &lt;&lt; 4,
} gnutls_privkey_flags_t;
</pre>
<p>
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><a name="GNUTLS-PRIVKEY-IMPORT-AUTO-RELEASE:CAPS"></a><span class="term"><code class="literal">GNUTLS_PRIVKEY_IMPORT_AUTO_RELEASE</code></span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><a name="GNUTLS-PRIVKEY-IMPORT-COPY:CAPS"></a><span class="term"><code class="literal">GNUTLS_PRIVKEY_IMPORT_COPY</code></span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><a name="GNUTLS-PRIVKEY-DISABLE-CALLBACKS:CAPS"></a><span class="term"><code class="literal">GNUTLS_PRIVKEY_DISABLE_CALLBACKS</code></span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><a name="GNUTLS-PRIVKEY-SIGN-FLAG-TLS1-RSA:CAPS"></a><span class="term"><code class="literal">GNUTLS_PRIVKEY_SIGN_FLAG_TLS1_RSA</code></span></p></td>
<td>
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-get-pk-algorithm"></a><h3>gnutls_privkey_get_pk_algorithm ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_get_pk_algorithm     (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *bits</code></em>);</pre>
<p>
This function will return the public key algorithm of a private
key and if possible will return a number of bits that indicates
the security parameter of the key.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>should contain a <a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>bits</code></em>Â :</span></p></td>
<td>If set will return the number of bits of the parameters (may be NULL)</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>a member of the <a class="link" href="gnutls-gnutls.html#gnutls-pk-algorithm-t" title="enum gnutls_pk_algorithm_t"><span class="type">gnutls_pk_algorithm_t</span></a> enumeration on
success, or a negative error code on error.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-ext"></a><h3>gnutls_privkey_import_ext ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_ext           (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-pk-algorithm-t" title="enum gnutls_pk_algorithm_t"><span class="type">gnutls_pk_algorithm_t</span></a> pk</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-sign-func" title="gnutls_privkey_sign_func ()"><span class="type">gnutls_privkey_sign_func</span></a> sign_func</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-decrypt-func" title="gnutls_privkey_decrypt_func ()"><span class="type">gnutls_privkey_decrypt_func</span></a> decrypt_func</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will associate the given callbacks with the
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure. At least one of the two callbacks
must be non-null.
</p>
<p>
See also <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-ext2" title="gnutls_privkey_import_ext2 ()"><code class="function">gnutls_privkey_import_ext2()</code></a>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>pk</code></em>Â :</span></p></td>
<td>The public key algorithm</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdata</code></em>Â :</span></p></td>
<td>private data to be provided to the callbacks</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>sign_func</code></em>Â :</span></p></td>
<td>callback for signature operations</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>decrypt_func</code></em>Â :</span></p></td>
<td>callback for decryption operations</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Flags for the import</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-ext2"></a><h3>gnutls_privkey_import_ext2 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_ext2          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-pk-algorithm-t" title="enum gnutls_pk_algorithm_t"><span class="type">gnutls_pk_algorithm_t</span></a> pk</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-sign-func" title="gnutls_privkey_sign_func ()"><span class="type">gnutls_privkey_sign_func</span></a> sign_func</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-decrypt-func" title="gnutls_privkey_decrypt_func ()"><span class="type">gnutls_privkey_decrypt_func</span></a> decrypt_func</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-abstract.html#gnutls-privkey-deinit-func" title="gnutls_privkey_deinit_func ()"><span class="type">gnutls_privkey_deinit_func</span></a> deinit_func</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will associate the given callbacks with the
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure. At least one of the two callbacks
must be non-null. If a deinitialization function is provided
then flags is assumed to contain <a class="link" href="gnutls-abstract.html#GNUTLS-PRIVKEY-IMPORT-AUTO-RELEASE:CAPS"><code class="literal">GNUTLS_PRIVKEY_IMPORT_AUTO_RELEASE</code></a>.
</p>
<p>
Note that the signing function is supposed to "raw" sign data, i.e.,
without any hashing or preprocessing. In case of RSA the DigestInfo
will be provided, and the signing function is expected to do the PKCS #1
1.5 padding and the exponentiation.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>pk</code></em>Â :</span></p></td>
<td>The public key algorithm</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdata</code></em>Â :</span></p></td>
<td>private data to be provided to the callbacks</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>sign_func</code></em>Â :</span></p></td>
<td>callback for signature operations</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>decrypt_func</code></em>Â :</span></p></td>
<td>callback for decryption operations</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>deinit_func</code></em>Â :</span></p></td>
<td>a deinitialization function</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Flags for the import</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-openpgp"></a><h3>gnutls_privkey_import_openpgp ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_openpgp       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-openpgp-privkey-t"><span class="type">gnutls_openpgp_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given private key to the abstract
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure.
</p>
<p>
The <a href="gnutls-gnutls.html#gnutls-openpgp-privkey-t"><span class="type">gnutls_openpgp_privkey_t</span></a> object must not be deallocated
during the lifetime of this structure. The subkey set as
preferred will be used, or the master key otherwise.
</p>
<p>
<em class="parameter"><code>flags</code></em> might be zero or one of <a class="link" href="gnutls-abstract.html#GNUTLS-PRIVKEY-IMPORT-AUTO-RELEASE:CAPS"><code class="literal">GNUTLS_PRIVKEY_IMPORT_AUTO_RELEASE</code></a>
and <a class="link" href="gnutls-abstract.html#GNUTLS-PRIVKEY-IMPORT-COPY:CAPS"><code class="literal">GNUTLS_PRIVKEY_IMPORT_COPY</code></a>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The private key to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Flags for the import</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-openpgp-raw"></a><h3>gnutls_privkey_import_openpgp_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_openpgp_raw   (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-openpgp.html#gnutls-openpgp-crt-fmt-t" title="enum gnutls_openpgp_crt_fmt_t"><span class="type">gnutls_openpgp_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <a href="gnutls-openpgp.html#gnutls-openpgp-keyid-t"><span class="type">gnutls_openpgp_keyid_t</span></a> keyid</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *password</code></em>);</pre>
<p>
This function will import the given private key to the abstract
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em>Â :</span></p></td>
<td>The private key data to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>The format of the private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyid</code></em>Â :</span></p></td>
<td>The key id to use (optional)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>password</code></em>Â :</span></p></td>
<td>A password (optional)</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-pkcs11"></a><h3>gnutls_privkey_import_pkcs11 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_pkcs11        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-pkcs11-privkey-t"><span class="type">gnutls_pkcs11_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given private key to the abstract
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure.
</p>
<p>
The <a href="gnutls-gnutls.html#gnutls-pkcs11-privkey-t"><span class="type">gnutls_pkcs11_privkey_t</span></a> object must not be deallocated
during the lifetime of this structure.
</p>
<p>
<em class="parameter"><code>flags</code></em> might be zero or one of <a class="link" href="gnutls-abstract.html#GNUTLS-PRIVKEY-IMPORT-AUTO-RELEASE:CAPS"><code class="literal">GNUTLS_PRIVKEY_IMPORT_AUTO_RELEASE</code></a>
and <a class="link" href="gnutls-abstract.html#GNUTLS-PRIVKEY-IMPORT-COPY:CAPS"><code class="literal">GNUTLS_PRIVKEY_IMPORT_COPY</code></a>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The private key to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Flags for the import</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-pkcs11-url"></a><h3>gnutls_privkey_import_pkcs11_url ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_pkcs11_url    (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>);</pre>
<p>
This function will import a PKCS 11 private key to a <span class="type">gnutls_private_key_t</span>
structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>A key of type <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>url</code></em>Â :</span></p></td>
<td>A PKCS 11 url</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-tpm-raw"></a><h3>gnutls_privkey_import_tpm_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_tpm_raw       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *fdata</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-tpm.html#gnutls-tpmkey-fmt-t" title="enum gnutls_tpmkey_fmt_t"><span class="type">gnutls_tpmkey_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *srk_password</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *key_password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given private key to the abstract
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure. 
</p>
<p>
With respect to passwords the same as in <a class="link" href="gnutls-abstract.html#gnutls-privkey-import-tpm-url" title="gnutls_privkey_import_tpm_url ()"><code class="function">gnutls_privkey_import_tpm_url()</code></a> apply.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fdata</code></em>Â :</span></p></td>
<td>The TPM key to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>The format of the private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>srk_password</code></em>Â :</span></p></td>
<td>The password for the SRK key (optional)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key_password</code></em>Â :</span></p></td>
<td>A password for the key (optional)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-tpm-url"></a><h3>gnutls_privkey_import_tpm_url ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_tpm_url       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *srk_password</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *key_password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given private key to the abstract
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure.
</p>
<p>
Note that unless <a class="link" href="gnutls-abstract.html#GNUTLS-PRIVKEY-DISABLE-CALLBACKS:CAPS"><code class="literal">GNUTLS_PRIVKEY_DISABLE_CALLBACKS</code></a>
is specified, if incorrect (or NULL) passwords are given
the PKCS11 callback functions will be used to obtain the
correct passwords. Otherwise if the SRK password is wrong
<code class="literal">GNUTLS_E_TPM_SRK_PASSWORD_ERROR</code> is returned and if the key password
is wrong or not provided then <code class="literal">GNUTLS_E_TPM_KEY_PASSWORD_ERROR</code>
is returned.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>url</code></em>Â :</span></p></td>
<td>The URL of the TPM key to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>srk_password</code></em>Â :</span></p></td>
<td>The password for the SRK key (optional)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key_password</code></em>Â :</span></p></td>
<td>A password for the key (optional)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>One of the GNUTLS_PRIVKEY_* flags</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-url"></a><h3>gnutls_privkey_import_url ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_url           (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import a PKCS11 or TPM URL as a
private key. The supported URL types can be checked
using <code class="function">gnutls_url_is_supported()</code>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>A key of type <a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>url</code></em>Â :</span></p></td>
<td>A PKCS 11 url</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-x509"></a><h3>gnutls_privkey_import_x509 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_x509          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-privkey-t"><span class="type">gnutls_x509_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given private key to the abstract
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure.
</p>
<p>
The <a href="gnutls-gnutls.html#gnutls-x509-privkey-t"><span class="type">gnutls_x509_privkey_t</span></a> object must not be deallocated
during the lifetime of this structure.
</p>
<p>
<em class="parameter"><code>flags</code></em> might be zero or one of <a class="link" href="gnutls-abstract.html#GNUTLS-PRIVKEY-IMPORT-AUTO-RELEASE:CAPS"><code class="literal">GNUTLS_PRIVKEY_IMPORT_AUTO_RELEASE</code></a>
and <a class="link" href="gnutls-abstract.html#GNUTLS-PRIVKEY-IMPORT-COPY:CAPS"><code class="literal">GNUTLS_PRIVKEY_IMPORT_COPY</code></a>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The private key to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Flags for the import</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-import-x509-raw"></a><h3>gnutls_privkey_import_x509_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_import_x509_raw      (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given private key to the abstract
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure. 
</p>
<p>
The supported formats are basic unencrypted key, PKCS8, PKCS12, 
and the openssl format.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em>Â :</span></p></td>
<td>The private key data to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>The format of the private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>password</code></em>Â :</span></p></td>
<td>A password (optional)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>an ORed sequence of gnutls_pkcs_encrypt_flags_t</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-init"></a><h3>gnutls_privkey_init ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_init                 (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> *key</code></em>);</pre>
<p>
This function will initialize an private key structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The structure to be initialized</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-set-pin-function"></a><h3>gnutls_privkey_set_pin_function ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>                gnutls_privkey_set_pin_function     (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_pin_callback_t</span> fn</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>);</pre>
<p>
This function will set a callback function to be used when
required to access the object. This function overrides any other
global PIN functions.
</p>
<p>
Note that this function must be called right after initialization
to have effect.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>A key of type <a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fn</code></em>Â :</span></p></td>
<td>the callback</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdata</code></em>Â :</span></p></td>
<td>data associated with the callback</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-sign-data"></a><h3>gnutls_privkey_sign_data ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_sign_data            (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> signer</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> hash</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *signature</code></em>);</pre>
<p>
This function will sign the given data using a signature algorithm
supported by the private key. Signature algorithms are always used
together with a hash functions.  Different hash functions may be
used for the RSA algorithm, but only the SHA family for the DSA keys.
</p>
<p>
You may use <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-preferred-hash-algorithm" title="gnutls_pubkey_get_preferred_hash_algorithm ()"><code class="function">gnutls_pubkey_get_preferred_hash_algorithm()</code></a> to determine
the hash algorithm.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>signer</code></em>Â :</span></p></td>
<td>Holds the key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hash</code></em>Â :</span></p></td>
<td>should be a digest algorithm</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Zero or one of <a class="link" href="gnutls-abstract.html#gnutls-privkey-flags-t" title="enum gnutls_privkey_flags_t"><code class="literal">gnutls_privkey_flags_t</code></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em>Â :</span></p></td>
<td>holds the data to be signed</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>signature</code></em>Â :</span></p></td>
<td>will contain the signature allocate with <a href="gnutls-gnutls.html#gnutls-malloc"><code class="function">gnutls_malloc()</code></a>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-sign-func"></a><h3>gnutls_privkey_sign_func ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 (*gnutls_privkey_sign_func)         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *raw_data</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *signature</code></em>);</pre>
<p>
</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-sign-hash"></a><h3>gnutls_privkey_sign_hash ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_sign_hash            (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> signer</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> hash_algo</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *hash_data</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *signature</code></em>);</pre>
<p>
This function will sign the given hashed data using a signature algorithm
supported by the private key. Signature algorithms are always used
together with a hash functions.  Different hash functions may be
used for the RSA algorithm, but only SHA-XXX for the DSA keys.
</p>
<p>
You may use <a class="link" href="gnutls-abstract.html#gnutls-pubkey-get-preferred-hash-algorithm" title="gnutls_pubkey_get_preferred_hash_algorithm ()"><code class="function">gnutls_pubkey_get_preferred_hash_algorithm()</code></a> to determine
the hash algorithm.
</p>
<p>
Note that if <a class="link" href="gnutls-abstract.html#GNUTLS-PRIVKEY-SIGN-FLAG-TLS1-RSA:CAPS"><code class="literal">GNUTLS_PRIVKEY_SIGN_FLAG_TLS1_RSA</code></a> flag is specified this function
will ignore <em class="parameter"><code>hash_algo</code></em> and perform a raw PKCS1 signature.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>signer</code></em>Â :</span></p></td>
<td>Holds the signer's key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hash_algo</code></em>Â :</span></p></td>
<td>The hash algorithm used</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Zero or one of <a class="link" href="gnutls-abstract.html#gnutls-privkey-flags-t" title="enum gnutls_privkey_flags_t"><code class="literal">gnutls_privkey_flags_t</code></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hash_data</code></em>Â :</span></p></td>
<td>holds the data to be signed</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>signature</code></em>Â :</span></p></td>
<td>will contain newly allocated signature</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-privkey-status"></a><h3>gnutls_privkey_status ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_privkey_status               (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>);</pre>
<p>
Checks the status of the private key token. This function
is an actual wrapper over <a class="link" href="gnutls-pkcs11.html#gnutls-pkcs11-privkey-status" title="gnutls_pkcs11_privkey_status ()"><code class="function">gnutls_pkcs11_privkey_status()</code></a>, and
if the private key is a PKCS <span class="type">11</span> token it will check whether
it is inserted or not.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the key</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>this function will return non-zero if the token
holding the private key is still available (inserted), and zero otherwise.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.10</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-deinit"></a><h3>gnutls_pubkey_deinit ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>                gnutls_pubkey_deinit                (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>);</pre>
<p>
This function will deinitialize a public key structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The structure to be deinitialized</td>
</tr></tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-encrypt-data"></a><h3>gnutls_pubkey_encrypt_data ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_encrypt_data          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *plaintext</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *ciphertext</code></em>);</pre>
<p>
This function will encrypt the given data, using the public
key.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be 0 for now</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>plaintext</code></em>Â :</span></p></td>
<td>The data to be encrypted</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ciphertext</code></em>Â :</span></p></td>
<td>contains the encrypted data</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-export"></a><h3>gnutls_pubkey_export ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_export                (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *output_data</code></em>,
                                                         <em class="parameter"><code><span class="type">size_t</span> *output_data_size</code></em>);</pre>
<p>
This function will export the public key to DER or PEM format.
The contents of the exported data is the SubjectPublicKeyInfo
X.509 structure.
</p>
<p>
If the buffer provided is not long enough to hold the output, then
*output_data_size is updated and <a href="gnutls-gnutls.html#GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><code class="literal">GNUTLS_E_SHORT_MEMORY_BUFFER</code></a> will
be returned.
</p>
<p>
If the structure is PEM encoded, it will have a header
of "BEGIN CERTIFICATE".
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the certificate</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>the format of output params. One of PEM or DER.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>output_data</code></em>Â :</span></p></td>
<td>will contain a certificate PEM or DER encoded</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>output_data_size</code></em>Â :</span></p></td>
<td>holds the size of output_data (and will be
replaced by the actual size of parameters)</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>In case of failure a negative error code will be
returned, and 0 on success.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-export2"></a><h3>gnutls_pubkey_export2 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_export2               (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *out</code></em>);</pre>
<p>
This function will export the public key to DER or PEM format.
The contents of the exported data is the SubjectPublicKeyInfo
X.509 structure.
</p>
<p>
The output buffer will be allocated using <a href="gnutls-gnutls.html#gnutls-malloc"><code class="function">gnutls_malloc()</code></a>.
</p>
<p>
If the structure is PEM encoded, it will have a header
of "BEGIN CERTIFICATE".
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the certificate</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>the format of output params. One of PEM or DER.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>out</code></em>Â :</span></p></td>
<td>will contain a certificate PEM or DER encoded</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>In case of failure a negative error code will be
returned, and 0 on success.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.3</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-flags-t"></a><h3>enum gnutls_pubkey_flags_t</h3>
<pre class="programlisting">typedef enum {
	GNUTLS_PUBKEY_VERIFY_FLAG_TLS1_RSA = 1,
	GNUTLS_PUBKEY_DISABLE_CALLBACKS = 1 &lt;&lt; 2,
	GNUTLS_PUBKEY_GET_OPENPGP_FINGERPRINT = 1 &lt;&lt; 3,
} gnutls_pubkey_flags_t;
</pre>
<p>
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><a name="GNUTLS-PUBKEY-VERIFY-FLAG-TLS1-RSA:CAPS"></a><span class="term"><code class="literal">GNUTLS_PUBKEY_VERIFY_FLAG_TLS1_RSA</code></span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><a name="GNUTLS-PUBKEY-DISABLE-CALLBACKS:CAPS"></a><span class="term"><code class="literal">GNUTLS_PUBKEY_DISABLE_CALLBACKS</code></span></p></td>
<td>
</td>
</tr>
<tr>
<td><p><a name="GNUTLS-PUBKEY-GET-OPENPGP-FINGERPRINT:CAPS"></a><span class="term"><code class="literal">GNUTLS_PUBKEY_GET_OPENPGP_FINGERPRINT</code></span></p></td>
<td>
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-key-id"></a><h3>gnutls_pubkey_get_key_id ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_key_id            (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">char</span> *output_data</code></em>,
                                                         <em class="parameter"><code><span class="type">size_t</span> *output_data_size</code></em>);</pre>
<p>
This function will return a unique ID that depends on the public
key parameters. This ID can be used in checking whether a
certificate corresponds to the given public key.
</p>
<p>
If the buffer provided is not long enough to hold the output, then
*output_data_size is updated and <a href="gnutls-gnutls.html#GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><code class="literal">GNUTLS_E_SHORT_MEMORY_BUFFER</code></a> will
be returned.  The output will normally be a SHA-1 hash output,
which is 20 bytes.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be 0 for now</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>output_data</code></em>Â :</span></p></td>
<td>will contain the key ID</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>output_data_size</code></em>Â :</span></p></td>
<td>holds the size of output_data (and will be
replaced by the actual size of parameters)</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>In case of failure a negative error code will be
returned, and 0 on success.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-key-usage"></a><h3>gnutls_pubkey_get_key_usage ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_key_usage         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *usage</code></em>);</pre>
<p>
This function will return the key usage of the public key.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>should contain a <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>usage</code></em>Â :</span></p></td>
<td>If set will return the number of bits of the parameters (may be NULL)</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-openpgp-key-id"></a><h3>gnutls_pubkey_get_openpgp_key_id ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_openpgp_key_id    (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">char</span> *output_data</code></em>,
                                                         <em class="parameter"><code><span class="type">size_t</span> *output_data_size</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *subkey</code></em>);</pre>
<p>
This function returns the OpenPGP key ID of the corresponding key.
The key is a unique ID that depends on the public
key parameters. 
</p>
<p>
If the flag <a class="link" href="gnutls-abstract.html#GNUTLS-PUBKEY-GET-OPENPGP-FINGERPRINT:CAPS"><code class="literal">GNUTLS_PUBKEY_GET_OPENPGP_FINGERPRINT</code></a> is specified
this function returns the fingerprint of the master key.
</p>
<p>
If the buffer provided is not long enough to hold the output, then
*output_data_size is updated and <a href="gnutls-gnutls.html#GNUTLS-E-SHORT-MEMORY-BUFFER:CAPS"><code class="literal">GNUTLS_E_SHORT_MEMORY_BUFFER</code></a> will
be returned.  The output is <a class="link" href="gnutls-openpgp.html#GNUTLS-OPENPGP-KEYID-SIZE:CAPS" title="GNUTLS_OPENPGP_KEYID_SIZE"><code class="literal">GNUTLS_OPENPGP_KEYID_SIZE</code></a> bytes long.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be 0 or <a class="link" href="gnutls-abstract.html#GNUTLS-PUBKEY-GET-OPENPGP-FINGERPRINT:CAPS"><code class="literal">GNUTLS_PUBKEY_GET_OPENPGP_FINGERPRINT</code></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>output_data</code></em>Â :</span></p></td>
<td>will contain the key ID</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>output_data_size</code></em>Â :</span></p></td>
<td>holds the size of output_data (and will be
replaced by the actual size of parameters)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>subkey</code></em>Â :</span></p></td>
<td>Will be non zero if the key ID corresponds to a subkey</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>In case of failure a negative error code will be
returned, and 0 on success.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-pk-algorithm"></a><h3>gnutls_pubkey_get_pk_algorithm ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_pk_algorithm      (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *bits</code></em>);</pre>
<p>
This function will return the public key algorithm of a public
key and if possible will return a number of bits that indicates
the security parameter of the key.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>should contain a <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>bits</code></em>Â :</span></p></td>
<td>If set will return the number of bits of the parameters (may be NULL)</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>a member of the <a class="link" href="gnutls-gnutls.html#gnutls-pk-algorithm-t" title="enum gnutls_pk_algorithm_t"><span class="type">gnutls_pk_algorithm_t</span></a> enumeration on
success, or a negative error code on error.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-pk-dsa-raw"></a><h3>gnutls_pubkey_get_pk_dsa_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_pk_dsa_raw        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *p</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *q</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *g</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *y</code></em>);</pre>
<p>
This function will export the DSA public key's parameters found in
the given certificate.  The new parameters will be allocated using
<a href="gnutls-gnutls.html#gnutls-malloc"><code class="function">gnutls_malloc()</code></a> and will be stored in the appropriate datum.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>p</code></em>Â :</span></p></td>
<td>will hold the p</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>q</code></em>Â :</span></p></td>
<td>will hold the q</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>g</code></em>Â :</span></p></td>
<td>will hold the g</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>y</code></em>Â :</span></p></td>
<td>will hold the y</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>
<a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> on success, otherwise a negative error code.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-pk-ecc-raw"></a><h3>gnutls_pubkey_get_pk_ecc_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_pk_ecc_raw        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-ecc-curve-t" title="enum gnutls_ecc_curve_t"><span class="type">gnutls_ecc_curve_t</span></a> *curve</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *x</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *y</code></em>);</pre>
<p>
This function will export the ECC public key's parameters found in
the given certificate.  The new parameters will be allocated using
<a href="gnutls-gnutls.html#gnutls-malloc"><code class="function">gnutls_malloc()</code></a> and will be stored in the appropriate datum.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>curve</code></em>Â :</span></p></td>
<td>will hold the curve</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>x</code></em>Â :</span></p></td>
<td>will hold x</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>y</code></em>Â :</span></p></td>
<td>will hold y</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>
<a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> on success, otherwise a negative error code.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-pk-ecc-x962"></a><h3>gnutls_pubkey_get_pk_ecc_x962 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_pk_ecc_x962       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *parameters</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *ecpoint</code></em>);</pre>
<p>
This function will export the ECC public key's parameters found in
the given certificate.  The new parameters will be allocated using
<a href="gnutls-gnutls.html#gnutls-malloc"><code class="function">gnutls_malloc()</code></a> and will be stored in the appropriate datum.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>parameters</code></em>Â :</span></p></td>
<td>DER encoding of an ANSI X9.62 parameters</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ecpoint</code></em>Â :</span></p></td>
<td>DER encoding of ANSI X9.62 ECPoint</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>
<a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> on success, otherwise a negative error code.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-pk-rsa-raw"></a><h3>gnutls_pubkey_get_pk_rsa_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_pk_rsa_raw        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *m</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_datum_t</span> *e</code></em>);</pre>
<p>
This function will export the RSA public key's parameters found in
the given structure.  The new parameters will be allocated using
<a href="gnutls-gnutls.html#gnutls-malloc"><code class="function">gnutls_malloc()</code></a> and will be stored in the appropriate datum.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the certificate</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>m</code></em>Â :</span></p></td>
<td>will hold the modulus</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>e</code></em>Â :</span></p></td>
<td>will hold the public exponent</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>
<a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> on success, otherwise a negative error code.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-preferred-hash-algorithm"></a><h3>gnutls_pubkey_get_preferred_hash_algorithm ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_preferred_hash_algorithm
                                                        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> *hash</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> *mand</code></em>);</pre>
<p>
This function will read the certifcate and return the appropriate digest
algorithm to use for signing with this certificate. Some certificates (i.e.
DSA might not be able to sign without the preferred algorithm).
</p>
<p>
To get the signature algorithm instead of just the hash use <a class="link" href="gnutls-gnutls.html#gnutls-pk-to-sign" title="gnutls_pk_to_sign ()"><code class="function">gnutls_pk_to_sign()</code></a>
with the algorithm of the certificate/key and the provided <em class="parameter"><code>hash</code></em>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the certificate</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hash</code></em>Â :</span></p></td>
<td>The result of the call with the hash algorithm used for signature</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>mand</code></em>Â :</span></p></td>
<td>If non zero it means that the algorithm MUST use this hash. May be NULL.</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>the 0 if the hash algorithm is found. A negative error code is
returned on error.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-get-verify-algorithm"></a><h3>gnutls_pubkey_get_verify_algorithm ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_get_verify_algorithm  (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *signature</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> *hash</code></em>);</pre>
<p>
This function will read the certifcate and the signed data to
determine the hash algorithm used to generate the signature.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the certificate</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>signature</code></em>Â :</span></p></td>
<td>contains the signature</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hash</code></em>Â :</span></p></td>
<td>The result of the call with the hash algorithm used for signature</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import"></a><h3>gnutls_pubkey_import ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import                (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>);</pre>
<p>
This function will import the provided public key in
a SubjectPublicKeyInfo X.509 structure to a native
<a href="gnutls-abstract.html#gnutls-pubkey-t"><code class="literal">gnutls_pubkey_t</code></a> structure. The output will be stored 
in <em class="parameter"><code>key</code></em>. If the public key is PEM encoded it should have a header 
of "PUBLIC KEY".
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The structure to store the parsed public key.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em>Â :</span></p></td>
<td>The DER or PEM encoded certificate.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>One of DER or PEM</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-dsa-raw"></a><h3>gnutls_pubkey_import_dsa_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_dsa_raw        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *p</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *q</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *g</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *y</code></em>);</pre>
<p>
This function will convert the given DSA raw parameters to the
native <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> format.  The output will be stored
in <em class="parameter"><code>key</code></em>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The structure to store the parsed key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>p</code></em>Â :</span></p></td>
<td>holds the p</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>q</code></em>Â :</span></p></td>
<td>holds the q</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>g</code></em>Â :</span></p></td>
<td>holds the g</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>y</code></em>Â :</span></p></td>
<td>holds the y</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-ecc-raw"></a><h3>gnutls_pubkey_import_ecc_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_ecc_raw        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-ecc-curve-t" title="enum gnutls_ecc_curve_t"><span class="type">gnutls_ecc_curve_t</span></a> curve</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *x</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *y</code></em>);</pre>
<p>
This function will convert the given elliptic curve parameters to a
<a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a>.  The output will be stored in <em class="parameter"><code>key</code></em>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The structure to store the parsed key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>curve</code></em>Â :</span></p></td>
<td>holds the curve</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>x</code></em>Â :</span></p></td>
<td>holds the x</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>y</code></em>Â :</span></p></td>
<td>holds the y</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-ecc-x962"></a><h3>gnutls_pubkey_import_ecc_x962 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_ecc_x962       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *parameters</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *ecpoint</code></em>);</pre>
<p>
This function will convert the given elliptic curve parameters to a
<a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a>.  The output will be stored in <em class="parameter"><code>key</code></em>.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The structure to store the parsed key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>parameters</code></em>Â :</span></p></td>
<td>DER encoding of an ANSI X9.62 parameters</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>ecpoint</code></em>Â :</span></p></td>
<td>DER encoding of ANSI X9.62 ECPoint</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-openpgp"></a><h3>gnutls_pubkey_import_openpgp ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_openpgp        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-openpgp-crt-t"><span class="type">gnutls_openpgp_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
Imports a public key from an openpgp key. This function will import
the given public key to the abstract <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a>
structure. The subkey set as preferred will be imported or the
master key otherwise.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crt</code></em>Â :</span></p></td>
<td>The certificate to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-openpgp-raw"></a><h3>gnutls_pubkey_import_openpgp_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_openpgp_raw    (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-openpgp.html#gnutls-openpgp-crt-fmt-t" title="enum gnutls_openpgp_crt_fmt_t"><span class="type">gnutls_openpgp_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <a href="gnutls-openpgp.html#gnutls-openpgp-keyid-t"><span class="type">gnutls_openpgp_keyid_t</span></a> keyid</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given public key to the abstract
<a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em>Â :</span></p></td>
<td>The public key data to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>The format of the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>keyid</code></em>Â :</span></p></td>
<td>The key id to use (optional)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.3</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-pkcs11"></a><h3>gnutls_pubkey_import_pkcs11 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_pkcs11         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-pkcs11.html#gnutls-pkcs11-obj-t" title="gnutls_pkcs11_obj_t"><span class="type">gnutls_pkcs11_obj_t</span></a> obj</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
Imports a public key from a pkcs11 key. This function will import
the given public key to the abstract <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>obj</code></em>Â :</span></p></td>
<td>The parameters to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-pkcs11-url"></a><h3>gnutls_pubkey_import_pkcs11_url ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_pkcs11_url     (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import a PKCS 11 certificate to a <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a>
structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>A key of type <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>url</code></em>Â :</span></p></td>
<td>A PKCS 11 url</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>One of GNUTLS_PKCS11_OBJ_* flags</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-privkey"></a><h3>gnutls_pubkey_import_privkey ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_privkey        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> usage</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
Imports the public key from a private.  This function will import
the given public key to the abstract <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>usage</code></em>Â :</span></p></td>
<td>GNUTLS_KEY_* key usage flags.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-rsa-raw"></a><h3>gnutls_pubkey_import_rsa_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_rsa_raw        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *m</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *e</code></em>);</pre>
<p>
This function will replace the parameters in the given structure.
The new parameters should be stored in the appropriate
gnutls_datum.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Is a structure will hold the parameters</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>m</code></em>Â :</span></p></td>
<td>holds the modulus</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>e</code></em>Â :</span></p></td>
<td>holds the public exponent</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>
<a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> on success, or an negative error code.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-tpm-raw"></a><h3>gnutls_pubkey_import_tpm_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_tpm_raw        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *fdata</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-tpm.html#gnutls-tpmkey-fmt-t" title="enum gnutls_tpmkey_fmt_t"><span class="type">gnutls_tpmkey_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *srk_password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the public key from the provided TPM key
structure.
</p>
<p>
With respect to passwords the same as in
<a class="link" href="gnutls-abstract.html#gnutls-pubkey-import-tpm-url" title="gnutls_pubkey_import_tpm_url ()"><code class="function">gnutls_pubkey_import_tpm_url()</code></a> apply.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fdata</code></em>Â :</span></p></td>
<td>The TPM key to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>The format of the private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>srk_password</code></em>Â :</span></p></td>
<td>The password for the SRK key (optional)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>One of the GNUTLS_PUBKEY_* flags</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-tpm-url"></a><h3>gnutls_pubkey_import_tpm_url ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_tpm_url        (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *srk_password</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given private key to the abstract
<a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> structure. 
</p>
<p>
Note that unless <a class="link" href="gnutls-abstract.html#GNUTLS-PUBKEY-DISABLE-CALLBACKS:CAPS"><code class="literal">GNUTLS_PUBKEY_DISABLE_CALLBACKS</code></a>
is specified, if incorrect (or NULL) passwords are given
the PKCS11 callback functions will be used to obtain the
correct passwords. Otherwise if the SRK password is wrong
<code class="literal">GNUTLS_E_TPM_SRK_PASSWORD_ERROR</code> is returned.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>url</code></em>Â :</span></p></td>
<td>The URL of the TPM key to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>srk_password</code></em>Â :</span></p></td>
<td>The password for the SRK key (optional)</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-url"></a><h3>gnutls_pubkey_import_url ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_url            (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>const <span class="type">char</span> *url</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import a PKCS11 certificate or a TPM key 
as a public key.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>A key of type <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>url</code></em>Â :</span></p></td>
<td>A PKCS 11 url</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>One of GNUTLS_PKCS11_OBJ_* flags</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-x509"></a><h3>gnutls_pubkey_import_x509 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_x509           (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given public key to the abstract
<a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crt</code></em>Â :</span></p></td>
<td>The certificate to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-x509-crq"></a><h3>gnutls_pubkey_import_x509_crq ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_x509_crq       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-x509.html#gnutls-x509-crq-t"><span class="type">gnutls_x509_crq_t</span></a> crq</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given public key to the abstract
<a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>crq</code></em>Â :</span></p></td>
<td>The certificate to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.5</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-import-x509-raw"></a><h3>gnutls_pubkey_import_x509_raw ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_import_x509_raw       (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pkey</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-x509-crt-fmt-t" title="enum gnutls_x509_crt_fmt_t"><span class="type">gnutls_x509_crt_fmt_t</span></a> format</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will import the given public key to the abstract
<a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pkey</code></em>Â :</span></p></td>
<td>The public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em>Â :</span></p></td>
<td>The public key data to be imported</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>format</code></em>Â :</span></p></td>
<td>The format of the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>should be zero</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.3</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-init"></a><h3>gnutls_pubkey_init ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_init                  (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> *key</code></em>);</pre>
<p>
This function will initialize an public key structure.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>The structure to be initialized</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-set-key-usage"></a><h3>gnutls_pubkey_set_key_usage ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_set_key_usage         (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> usage</code></em>);</pre>
<p>
This function will set the key usage flags of the public key. This
is only useful if the key is to be exported to a certificate or
certificate request.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>a certificate of type <a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>usage</code></em>Â :</span></p></td>
<td>an ORed sequence of the GNUTLS_KEY_* elements.</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-set-pin-function"></a><h3>gnutls_pubkey_set_pin_function ()</h3>
<pre class="programlisting"><span class="returnvalue">void</span>                gnutls_pubkey_set_pin_function      (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><span class="type">gnutls_pin_callback_t</span> fn</code></em>,
                                                         <em class="parameter"><code><span class="type">void</span> *userdata</code></em>);</pre>
<p>
This function will set a callback function to be used when
required to access the object. This function overrides any other
global PIN functions.
</p>
<p>
Note that this function must be called right after initialization
to have effect.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>A key of type <a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>fn</code></em>Â :</span></p></td>
<td>the callback</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>userdata</code></em>Â :</span></p></td>
<td>data associated with the callback</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.1.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-verify-data"></a><h3>gnutls_pubkey_verify_data ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_verify_data           (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pubkey</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *signature</code></em>);</pre>
<p>
This function will verify the given signed data, using the
parameters from the certificate.
</p>
<p>
Deprecated. This function cannot be easily used securely. 
Use <a class="link" href="gnutls-abstract.html#gnutls-pubkey-verify-data2" title="gnutls_pubkey_verify_data2 ()"><code class="function">gnutls_pubkey_verify_data2()</code></a> instead.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pubkey</code></em>Â :</span></p></td>
<td>Holds the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Zero or one of <a class="link" href="gnutls-abstract.html#gnutls-pubkey-flags-t" title="enum gnutls_pubkey_flags_t"><code class="literal">gnutls_pubkey_flags_t</code></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em>Â :</span></p></td>
<td>holds the signed data</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>signature</code></em>Â :</span></p></td>
<td>contains the signature</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>In case of a verification failure <a href="gnutls-gnutls.html#GNUTLS-E-PK-SIG-VERIFY-FAILED:CAPS"><code class="literal">GNUTLS_E_PK_SIG_VERIFY_FAILED</code></a>
is returned, and zero or positive code on success.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-verify-data2"></a><h3>gnutls_pubkey_verify_data2 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_verify_data2          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> pubkey</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-sign-algorithm-t" title="enum gnutls_sign_algorithm_t"><span class="type">gnutls_sign_algorithm_t</span></a> algo</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *data</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *signature</code></em>);</pre>
<p>
This function will verify the given signed data, using the
parameters from the certificate.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>pubkey</code></em>Â :</span></p></td>
<td>Holds the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>algo</code></em>Â :</span></p></td>
<td>The signature algorithm used</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Zero or one of <a class="link" href="gnutls-abstract.html#gnutls-pubkey-flags-t" title="enum gnutls_pubkey_flags_t"><code class="literal">gnutls_pubkey_flags_t</code></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>data</code></em>Â :</span></p></td>
<td>holds the signed data</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>signature</code></em>Â :</span></p></td>
<td>contains the signature</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>In case of a verification failure <a href="gnutls-gnutls.html#GNUTLS-E-PK-SIG-VERIFY-FAILED:CAPS"><code class="literal">GNUTLS_E_PK_SIG_VERIFY_FAILED</code></a>
is returned, and zero or positive code on success.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-pubkey-verify-hash2"></a><h3>gnutls_pubkey_verify_hash2 ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_pubkey_verify_hash2          (<em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-sign-algorithm-t" title="enum gnutls_sign_algorithm_t"><span class="type">gnutls_sign_algorithm_t</span></a> algo</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *hash</code></em>,
                                                         <em class="parameter"><code>const <span class="type">gnutls_datum_t</span> *signature</code></em>);</pre>
<p>
This function will verify the given signed digest, using the
parameters from the public key.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>Holds the public key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>algo</code></em>Â :</span></p></td>
<td>The signature algorithm used</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>Zero or one of <a class="link" href="gnutls-abstract.html#gnutls-pubkey-flags-t" title="enum gnutls_pubkey_flags_t"><code class="literal">gnutls_pubkey_flags_t</code></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>hash</code></em>Â :</span></p></td>
<td>holds the hash digest to be verified</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>signature</code></em>Â :</span></p></td>
<td>contains the signature</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>In case of a verification failure <a href="gnutls-gnutls.html#GNUTLS-E-PK-SIG-VERIFY-FAILED:CAPS"><code class="literal">GNUTLS_E_PK_SIG_VERIFY_FAILED</code></a>
is returned, and zero or positive code on success.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 3.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-x509-crl-privkey-sign"></a><h3>gnutls_x509_crl_privkey_sign ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_x509_crl_privkey_sign        (<em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crl-t"><span class="type">gnutls_x509_crl_t</span></a> crl</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> issuer</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> issuer_key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> dig</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will sign the CRL with the issuer's private key, and
will copy the issuer's information into the CRL.
</p>
<p>
This must be the last step in a certificate CRL since all
the previously set parameters are now signed.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>crl</code></em>Â :</span></p></td>
<td>should contain a gnutls_x509_crl_t structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>issuer</code></em>Â :</span></p></td>
<td>is the certificate of the certificate issuer</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>issuer_key</code></em>Â :</span></p></td>
<td>holds the issuer's private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>dig</code></em>Â :</span></p></td>
<td>The message digest to use. GNUTLS_DIG_SHA1 is the safe choice unless you know what you're doing.</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>must be 0</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.
Since 2.12.0</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-x509-crq-privkey-sign"></a><h3>gnutls_x509_crq_privkey_sign ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_x509_crq_privkey_sign        (<em class="parameter"><code><a href="gnutls-x509.html#gnutls-x509-crq-t"><span class="type">gnutls_x509_crq_t</span></a> crq</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> dig</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will sign the certificate request with a private key.
This must be the same key as the one used in
<a class="link" href="gnutls-x509.html#gnutls-x509-crt-set-key" title="gnutls_x509_crt_set_key ()"><code class="function">gnutls_x509_crt_set_key()</code></a> since a certificate request is self
signed.
</p>
<p>
This must be the last step in a certificate request generation
since all the previously set parameters are now signed.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>crq</code></em>Â :</span></p></td>
<td>should contain a <a href="gnutls-x509.html#gnutls-x509-crq-t"><span class="type">gnutls_x509_crq_t</span></a> structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>holds a private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>dig</code></em>Â :</span></p></td>
<td>The message digest to use, i.e., <a class="link" href="gnutls-gnutls.html#GNUTLS-DIG-SHA1:CAPS"><code class="literal">GNUTLS_DIG_SHA1</code></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>must be 0</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>
<a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> on success, otherwise a negative error code.
<a href="gnutls-gnutls.html#GNUTLS-E-ASN1-VALUE-NOT-FOUND:CAPS"><code class="literal">GNUTLS_E_ASN1_VALUE_NOT_FOUND</code></a> is returned if you didn't set all
information in the certificate request (e.g., the version using
<a class="link" href="gnutls-x509.html#gnutls-x509-crq-set-version" title="gnutls_x509_crq_set_version ()"><code class="function">gnutls_x509_crq_set_version()</code></a>).</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-x509-crq-set-pubkey"></a><h3>gnutls_x509_crq_set_pubkey ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_x509_crq_set_pubkey          (<em class="parameter"><code><a href="gnutls-x509.html#gnutls-x509-crq-t"><span class="type">gnutls_x509_crq_t</span></a> crq</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>);</pre>
<p>
This function will set the public parameters from the given public
key to the request.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>crq</code></em>Â :</span></p></td>
<td>should contain a <a href="gnutls-x509.html#gnutls-x509-crq-t"><span class="type">gnutls_x509_crq_t</span></a> structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>holds a public key</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-x509-crt-privkey-sign"></a><h3>gnutls_x509_crt_privkey_sign ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_x509_crt_privkey_sign        (<em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> issuer</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-privkey-t"><span class="type">gnutls_privkey_t</span></a> issuer_key</code></em>,
                                                         <em class="parameter"><code><a class="link" href="gnutls-gnutls.html#gnutls-digest-algorithm-t" title="enum gnutls_digest_algorithm_t"><span class="type">gnutls_digest_algorithm_t</span></a> dig</code></em>,
                                                         <em class="parameter"><code>unsigned <span class="type">int</span> flags</code></em>);</pre>
<p>
This function will sign the certificate with the issuer's private key, and
will copy the issuer's information into the certificate.
</p>
<p>
This must be the last step in a certificate generation since all
the previously set parameters are now signed.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>crt</code></em>Â :</span></p></td>
<td>a certificate of type <a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>issuer</code></em>Â :</span></p></td>
<td>is the certificate of the certificate issuer</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>issuer_key</code></em>Â :</span></p></td>
<td>holds the issuer's private key</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>dig</code></em>Â :</span></p></td>
<td>The message digest to use, <a class="link" href="gnutls-gnutls.html#GNUTLS-DIG-SHA1:CAPS"><code class="literal">GNUTLS_DIG_SHA1</code></a> is a safe choice</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>flags</code></em>Â :</span></p></td>
<td>must be 0</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2">
<a name="gnutls-x509-crt-set-pubkey"></a><h3>gnutls_x509_crt_set_pubkey ()</h3>
<pre class="programlisting"><span class="returnvalue">int</span>                 gnutls_x509_crt_set_pubkey          (<em class="parameter"><code><a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> crt</code></em>,
                                                         <em class="parameter"><code><a href="gnutls-abstract.html#gnutls-pubkey-t"><span class="type">gnutls_pubkey_t</span></a> key</code></em>);</pre>
<p>
This function will set the public parameters from the given public
key to the request.
</p>
<div class="variablelist"><table border="0" class="variablelist">
<colgroup>
<col align="left" valign="top">
<col>
</colgroup>
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>crt</code></em>Â :</span></p></td>
<td>should contain a <a href="gnutls-gnutls.html#gnutls-x509-crt-t"><span class="type">gnutls_x509_crt_t</span></a> structure</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>key</code></em>Â :</span></p></td>
<td>holds a public key</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span>Â :</span></p></td>
<td>On success, <a href="gnutls-gnutls.html#GNUTLS-E-SUCCESS:CAPS"><code class="literal">GNUTLS_E_SUCCESS</code></a> (0) is returned, otherwise a
negative error value.</td>
</tr>
</tbody>
</table></div>
<p class="since">Since 2.12.0</p>
</div>
</div>
</div>
<div class="footer">
<hr>
          Generated by GTK-Doc V1.19</div>
</body>
</html>